(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{413:function(e,t,i){var s;"undefined"!=typeof self&&self,s=function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=8)}([function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i(2);let r={js:(e,t)=>e===t?0:e<t?-1:1,"abstract-js":(e,t)=>e==t?0:e<t?-1:1,"abstract-date":(e,t)=>{let i=new Date(e).toISOString(),s=new Date(t).toISOString();return i==s?0:i<s?-1:1},loki:(e,t)=>Object(s.b)(e,t)?0:Object(s.c)(e,t,!1)?-1:1}},function(e,t,i){"use strict";(function(e){function s(){let t;return function(e){t=e}(void 0!==e&&e||this),t}i.d(t,"a",(function(){return r}));const r=function(){const e=s(),t=Symbol.for("LOKI");return void 0===e[t]&&(e[t]={}),e[t]}()}).call(this,i(7))},function(e,t,i){"use strict";function s(e,t){if(e===t)return!0;if(!e||!t||!0===e||!0===t||e!=e||t!=t){let i,s;switch(e){case void 0:case null:i=1;break;case!1:i=3;break;case!0:i=4;break;case"":i=5;break;default:i=e==e?9:0}switch(t){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=t==t?9:0}if(9!==i||9!==s)return i===s}let i=Number(e),s=Number(t);return i==i||s==s?i===s:(i=e.toString(),s=t.toString(),i==s)}function r(e,t,i){if(!e||!t||!0===e||!0===t||e!=e||t!=t){let s,r;switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}switch(t){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=t==t?9:0}if(9!==s||9!==r)return s===r?i:s<r}let s=Number(e),r=Number(t);return s==s&&r==r?s<r||!(s>r)&&i:s==s&&r!=r||(r!=r||s==s)&&(e<t||!(e>t)&&(e==t?i:(s=e.toString(),r=t.toString(),s<r||s==r&&i)))}function n(e,t,i){if(!e||!t||!0===e||!0===t||e!=e||t!=t){let s,r;switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}switch(t){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=t==t?9:0}if(9!==s||9!==r)return s===r?i:s>r}let s=Number(e),r=Number(t);return s==s&&r==r?s>r||!(s<r)&&i:(s!=s||r==r)&&(r==r&&s!=s||e>t||!(e<t)&&(e==t?i:(s=e.toString(),r=t.toString(),s>r||s==r&&i)))}function a(e,t,i){return s(e,t)?0:r(e,t,!1)?i?1:-1:n(e,t,!1)?i?-1:1:0}i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"a",(function(){return o}));class l{$eq(e,t){return e===t}$ne(e,t){return e!==t}$gt(e,t){return e>t}$gte(e,t){return e>=t}$lt(e,t){return e<t}$lte(e,t){return e<=t}$between(e,t){return null!=e&&e>=t[0]&&e<=t[1]}$in(e,t){return-1!==t.indexOf(e)}$nin(e,t){return-1===t.indexOf(e)}$keyin(e,t){return e in t}$nkeyin(e,t){return!(e in t)}$definedin(e,t){return void 0!==t[e]}$undefinedin(e,t){return void 0===t[e]}$regex(e,t){return t.test(e)}$containsNone(e,t){return!this.$containsAny(e,t)}$containsAny(e,t){const i=this.containsCheckFn(e);return null!==i&&(Array.isArray(t)?t.some(i):i(t))}$contains(e,t){const i=this.containsCheckFn(e);return null!==i&&(Array.isArray(t)?t.every(i):i(t))}$type(e,t){let i=typeof e;return"object"===i&&(Array.isArray(e)?i="array":e instanceof Date&&(i="date")),"object"!=typeof t?i===t:this.doQueryOp(i,t)}$finite(e,t){return t===isFinite(e)}$size(e,t){return!!Array.isArray(e)&&("object"!=typeof t?e.length===t:this.doQueryOp(e.length,t))}$len(e,t){return"string"==typeof e&&("object"!=typeof t?e.length===t:this.doQueryOp(e.length,t))}$where(e,t){return!0===t(e)}$not(e,t){return!this.doQueryOp(e,t)}$and(e,t){for(let i=0,s=t.length;i<s;i++)if(!this.doQueryOp(e,t[i]))return!1;return!0}$or(e,t){for(let i=0,s=t.length;i<s;i++)if(this.doQueryOp(e,t[i]))return!0;return!1}doQueryOp(e,t){for(let i in t)if(Object.hasOwnProperty.call(t,i))return this[i](e,t[i]);return!1}containsCheckFn(e){return"string"==typeof e||Array.isArray(e)?t=>-1!==e.indexOf(t):"object"==typeof e&&null!==e?t=>Object.hasOwnProperty.call(e,t):null}}let o={js:new l,loki:new class extends l{constructor(){super()}$eq(e,t){return s(e,t)}$ne(e,t){return!s(e,t)}$gt(e,t){return n(e,t,!1)}$gte(e,t){return n(e,t,!0)}$lt(e,t){return r(e,t,!1)}$lte(e,t){return r(e,t,!0)}$between(e,t){return null!=e&&n(e,t[0],!0)&&r(e,t[1],!0)}}}},function(e,t,i){"use strict";var s=i(5);class r{constructor(e){this._field=e,this._lokiMap={},this._valMap={}}set(e,t){if(null!=t){if(t in this._lokiMap)throw new Error("Duplicate key for property "+this._field+": "+t);if(e in this._valMap)throw new Error("Duplicate key for property $loki : "+e);this._lokiMap[t]=e,this._valMap[e]=t}}get(e){return this._lokiMap[e]}update(e,t){if(t!==this._valMap[e]){if(t in this._lokiMap)throw new Error("Duplicate key for property "+this._field+": "+t);this.remove(e),this.set(e,t)}}remove(e){if(!(e in this._valMap))throw new Error("Key is not in unique index: "+this._field);let t=this._valMap[e];delete this._lokiMap[t],delete this._valMap[e]}clear(){this._lokiMap={},this._valMap={}}}function n(e,t,i){return e instanceof Array?(e.push(i),e[e.length-1]):e instanceof Object?(e[t]=i,e[t]):void 0}function a(e,t){for(let i in e){let s=e[i];s instanceof Date?n(t,i,new Date(s.getTime())):s instanceof Function?n(t,i,s):s instanceof Array?a(s,n(t,i,[])):s instanceof Object?a(s,n(t,i,{})):n(t,i,s)}}function l(e){if(/number|string|boolean/.test(typeof e))return e;if(e instanceof Date)return new Date(e.getTime());const t=e instanceof Array?[]:{};return a(e,t),t}function o(e,t="parse-stringify"){if(null==e)return null;let i;switch(t){case"parse-stringify":i=JSON.parse(JSON.stringify(e));break;case"deep":i=l(e);break;case"shallow":i=Object.create(e.constructor.prototype),Object.assign(i,e);break;case"shallow-recurse":i=o(e,"shallow");const t=Object.keys(e);for(let s=0;s<t.length;s++){const r=t[s];"object"==typeof e[r]&&"Object"===e[r].constructor.name&&(i[r]=o(e[r],"shallow-recurse"))}}return i}var h=i(2),d=i(0);function c(e,t,i=0){if(++i>=10)return e;for(const s in e)if("string"==typeof e[s]&&0===e[s].indexOf("[%lktxp]")){const i=e[s].substring(8);void 0!==t[i]&&(e[s]=t[i])}else"object"==typeof e[s]&&(e[s]=c(e[s],t,i));return e}const u={$eq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};class _{constructor(e){this._filteredRows=[],this._filterInitialized=!1,this._scoring=null,this._collection=e}reset(){return this._filteredRows.length>0&&(this._filteredRows=[]),this._filterInitialized=!1,this}toJSON(){const e=this.copy();return e._collection=null,e}limit(e){return this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex()),this._filteredRows=this._filteredRows.slice(0,e),this._filterInitialized=!0,this}offset(e){return this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex()),this._filteredRows=this._filteredRows.slice(e),this._filterInitialized=!0,this}copy(){const e=new _(this._collection);return e._filteredRows=this._filteredRows.slice(),e._filterInitialized=this._filterInitialized,e}transform(e,t){"string"==typeof e&&(e=this._collection._transforms[e]),void 0!==t&&(e=function(e,t){if(void 0===t)return e;const i=[];for(let s=0;s<e.length;s++){const r=o(e[s],"shallow-recurse");i.push(c(r,t))}return i}(e,t));let i=this;for(let t=0;t<e.length;t++){const s=e[t];switch(s.type){case"find":i.find(s.value);break;case"where":i.where(s.value);break;case"simplesort":i.simplesort(s.property,s.options);break;case"compoundsort":i.compoundsort(s.value);break;case"sort":i.sort(s.value);break;case"sortByScoring":i.sortByScoring(s.desc);break;case"limit":i=i.limit(s.value);break;case"offset":i=i.offset(s.value);break;case"map":i=i.map(s.value,s.dataOptions);break;case"eqJoin":i=i.eqJoin(s.joinData,s.leftJoinKey,s.rightJoinKey,s.mapFun,s.dataOptions);break;case"mapReduce":i=i.mapReduce(s.mapFunction,s.reduceFunction);break;case"update":i.update(s.value);break;case"remove":i.remove()}}return i}sort(e){this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const t=this._collection._data;return this._filteredRows.sort(((i,s)=>e(t[i],t[s]))),this}simplesort(e,t={desc:!1}){if("boolean"==typeof t&&(t={desc:t}),!this._filterInitialized&&this._collection._rangedIndexes.hasOwnProperty(e)){let i=this._collection._rangedIndexes[e].index.rangeRequest(),s=[];for(let e of i)s.push(this._collection.get(e,!0)[1]);return this._filteredRows=t.desc?s.reverse():s,this._filterInitialized=!0,this}this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const i=this._collection._data;let s=t.sortComparator?d.a[t.sortComparator]:d.a[this._collection._unindexedSortComparator];return this._filteredRows.sort(((t,r)=>s(i[t][e],i[r][e]))),t.desc&&this._filteredRows.reverse(),this}compoundsort(e){if(0===e.length)throw new Error("Invalid call to compoundsort, need at least one property");if(1===e.length){const t=e[0];return"string"==typeof t?this.simplesort(t,!1):this.simplesort(t[0],t[1])}for(let t=0,i=e.length;t<i;t++){const i=e[t];"string"==typeof i&&(e[t]=[i,!1])}this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const t=this._collection._data;return this._filteredRows.sort(((i,s)=>this._compoundeval(e,t[i],t[s]))),this}_compoundeval(e,t,i){for(let s=0,r=e.length;s<r;s++){const r=e[s],n=r[0],a=Object(h.d)(t[n],i[n],r[1]);if(0!==a)return a}return 0}sortByScoring(e=!1){if(null===this._scoring)throw new Error("No scoring available");return e?this._filteredRows.sort(((e,t)=>this._scoring[e].score-this._scoring[t].score)):this._filteredRows.sort(((e,t)=>this._scoring[t].score-this._scoring[e].score)),this}getScoring(){if(null===this._scoring)throw new Error("No scoring available");const e=[];for(let t=0;t<this._filteredRows.length;t++)e.push(this._scoring[this._filteredRows[t]]);return e}findOr(e){const t=[],i=[],s=this.count();for(let r=0,n=e.length;r<n;r++){const n=this.copy().find(e[r])._filteredRows,a=n.length;if(a===s)return this;for(let e=0;e<a;e++){const s=n[e];void 0===i[s]&&(i[s]=!0,t.push(s))}}return this._filteredRows=t,this._filterInitialized=!0,this}$or(e){return this.findOr(e)}findAnd(e){for(let t=0,i=e.length;t<i;t++){if(0===this.count())return this;this.find(e[t])}return this}$and(e){return this.findAnd(e)}find(e,t=!1){if(0===this._collection._data.length)return this._filteredRows=[],this._filterInitialized=!0,this;const i=e||"getAll";let s,r,n;if("object"==typeof i){let e=[];for(let t in i){let n={};n[t]=i[t],e.push(n),void 0!==i[t]&&(s=t,r=i[t])}if(e.length>1)return this.find({$and:e},t)}if(!s||"getAll"===i)return t&&(this._filteredRows=this._collection._data.length>0?[0]:[],this._filterInitialized=!0),this;if("$and"===s||"$or"===s)return this[s](r),t&&this._filteredRows.length>1&&(this._filteredRows=this._filteredRows.slice(0,1)),this;let a="";if(null===r||"object"!=typeof r||r instanceof Date)a="$eq",n=r;else{if("object"!=typeof r)throw new Error("Do not know what you want to do.");for(let e in r)if(void 0!==r[e]){a=e,n=r[e];break}}"$regex"===a&&(Array.isArray(n)?n=new RegExp(n[0],n[1]):n instanceof RegExp||(n=new RegExp(n)));let l=!1;!this._filterInitialized&&this._collection._rangedIndexes[s]&&u[a]&&(l=!0);const o=h.a[this._collection._defaultLokiOperatorPackage],d=this._collection._data;let c=[];if(this._filterInitialized){let e=this._filteredRows;if("$fts"===s){this._scoring=this._collection._fullTextSearch.search(i.$fts);let t=Object.keys(this._scoring);for(let i=0;i<t.length;i++)-1!==e.indexOf(+t[i])&&c.push(+t[i])}else if(void 0!==this._collection._constraints.unique[s]&&"$eq"===a){const t=this._collection._constraints.unique[s].get(n);if(void 0!==t){const i=this._collection.get(t,!0)[1];-1!==e.indexOf(i)&&c.push(i)}}else for(let t=0;t<e.length;t++){let i=e[t];o[a](d[i][s],n)&&c.push(i)}return this._filteredRows=c,this._filterInitialized=!0,this}if(this._filteredRows=c,this._filterInitialized=!0,"$fts"===s){this._scoring=this._collection._fullTextSearch.search(i.$fts);let e=Object.keys(this._scoring);for(let t=0;t<e.length;t++)c.push(+e[t]);return this}if(void 0!==this._collection._constraints.unique[s]&&"$eq"===a){const e=this._collection._constraints.unique[s].get(n);return void 0!==e&&c.push(this._collection.get(e,!0)[1]),this}if(!l){for(let e=0;e<d.length;e++)if(o[a](d[e][s],n)&&(c.push(e),t))return this;return this}if(this._collection._rangedIndexes[s]){if("$in"===a){let e=this._collection._rangedIndexes[s];for(let t of n){let i=e.index.rangeRequest({op:"$eq",val:t});for(let e of i)c.push(this._collection.get(e,!0)[1])}return this}if("$between"===a){let e=this._collection._rangedIndexes[s].index.rangeRequest({op:a,val:n[0],high:n[1]});for(let t of e)c.push(this._collection.get(t,!0)[1]);return this}let e=this._collection._rangedIndexes[s].index.rangeRequest({op:a,val:n});if(!0!==u[a])for(let t of e){let e=this._collection.get(t,!0)[1];u[a](d[e][s],n)&&c.push(e)}else for(let t of e)c.push(this._collection.get(t,!0)[1])}return this}where(e){let t,i=[];if("function"!=typeof e)throw new TypeError("Argument is not a stored view or a function");if(t=e,this._filterInitialized){let e=this._filteredRows.length;for(;e--;)!0===t(this._collection._data[this._filteredRows[e]])&&i.push(this._filteredRows[e]);return this._filteredRows=i,this}{let e=this._collection._data.length;for(;e--;)!0===t(this._collection._data[e])&&i.push(e);return this._filteredRows=i,this._filterInitialized=!0,this}}count(){return this._filterInitialized?this._filteredRows.length:this._collection.count()}data(e={}){let t,i,s;({forceClones:t=!1,forceCloneMethod:i=this._collection._cloneMethod,removeMeta:s=!1}=e);let r,n,a=[],l=this._collection._data;if(s&&!t&&(t=!0,i="shallow"),this._collection._disableDeltaChangesApi||(t=!0,i="deep"),!this._filterInitialized){if(0===this._filteredRows.length){if(this._collection._cloneObjects||t){n=i;for(let e=0;e<l.length;e++)r=this._collection._defineNestedProperties(o(l[e],n)),s&&(delete r.$loki,delete r.meta),a.push(r);return a}return l.slice()}this._filterInitialized=!0}const h=this._filteredRows;if(this._collection._cloneObjects||t){n=i;for(let e=0;e<h.length;e++)r=this._collection._defineNestedProperties(o(l[h[e]],n)),s&&(delete r.$loki,delete r.meta),a.push(r)}else for(let e=0;e<h.length;e++)a.push(l[h[e]]);return a}update(e){this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const t=this._filteredRows.length,i=this._collection._data;for(let s=0;s<t;s++)if(this._collection._cloneObjects||!this._collection._disableDeltaChangesApi){const t=o(i[this._filteredRows[s]],this._collection._cloneMethod);e(t),this._collection.update(t)}else e(i[this._filteredRows[s]]),this._collection.update(i[this._filteredRows[s]]);return this}remove(){return this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex()),this._collection.remove(this.data()),this._filteredRows=[],this}mapReduce(e,t){try{return t(this.data().map(e))}catch(e){throw e}}eqJoin(e,t,i,s,r){let n,a,l=[],o=[],h="function"==typeof t,d="function"==typeof i,c={},u=this.data(r),f=u.length;if(e instanceof b)l=e.chain().data(r);else if(e instanceof _)l=e.data(r);else{if(!Array.isArray(e))throw new TypeError("joinData needs to be an array or result set");l=e}n=l.length;for(let e=0;e<n;e++)a=d?i(l[e]):l[e][i],c[a]=l[e];s||(s=(e,t)=>({left:e,right:t}));for(let e=0;e<f;e++)a=h?t(u[e]):u[e][t],o.push(s(u[e],c[a]||{}));return this._collection=new b("joinData"),this._collection.insert(o),this._filteredRows=[],this._filterInitialized=!1,this}map(e,t){const i=this.data(t).map(e);return this._collection=new b("mappedData"),this._collection.insert(i),this._filteredRows=[],this._filterInitialized=!1,this}}class f extends s.a{constructor(e,t,i={}){super(),this._rebuildPending=!1,this._resultData=[],this._resultDirty=!1,this._cachedResultSet=null,this._filterPipeline=[],this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._sortDirty=!1,({persistent:this._persistent=!1,sortPriority:this._sortPriority="passive",minRebuildInterval:this._minRebuildInterval=1}=i),this._collection=e,this.name=t,this._resultSet=new _(e),this._events={rebuild:[]}}_rematerialize({removeWhereFilters:e=!1}){if(this._resultData=[],this._resultDirty=!0,this._resultSet=new _(this._collection),(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||null!==this._sortByScoring)&&(this._sortDirty=!0),e){let e=this._filterPipeline.length;for(;e--;)"where"===this._filterPipeline[e].type&&(e!==this._filterPipeline.length-1&&(this._filterPipeline[e]=this._filterPipeline[this._filterPipeline.length-1]),this._filterPipeline.length--)}const t=this._filterPipeline;this._filterPipeline=[];for(let e=0;e<t.length;e++)this.applyFind(t[e].val);return this.data(),this.emit("rebuild",this),this}branchResultSet(e,t){const i=this._resultSet.copy();return void 0===e?i:i.transform(e,t)}toJSON(){return{name:this.name,_persistent:this._persistent,_sortPriority:this._sortPriority,_minRebuildInterval:this._minRebuildInterval,_resultSet:this._resultSet,_filterPipeline:this._filterPipeline,_sortCriteria:this._sortCriteria,_sortCriteriaSimple:this._sortCriteriaSimple,_sortByScoring:this._sortByScoring,_sortDirty:this._sortDirty}}static fromJSONObject(e,t){let i=new f(e,t.name);return i._resultDirty=!0,i._filterPipeline=t._filterPipeline,i._resultData=[],i._sortCriteria=t._sortCriteria,i._sortCriteriaSimple=t._sortCriteriaSimple,i._sortByScoring=t._sortByScoring,i._sortDirty=t._sortDirty,i._resultSet._filteredRows=t._resultSet._filteredRows,i._resultSet._filterInitialized=t._resultSet._filterInitialized,i._rematerialize({removeWhereFilters:!0}),i}removeFilters({queueSortPhase:e=!1}={}){this._rebuildPending=!1,this._resultSet.reset(),this._resultData=[],this._resultDirty=!0,this._cachedResultSet=null,this._filterPipeline=[],this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._sortDirty=!1,!0===e&&this._queueSortPhase()}applySort(e){return this._sortFunction=e,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._queueSortPhase(),this}applySimpleSort(e,t=!1){return this._sortCriteriaSimple={field:e,options:t},this._sortFunction=null,this._sortCriteria=null,this._sortByScoring=null,this._queueSortPhase(),this}applySortCriteria(e){return this._sortCriteria=e,this._sortCriteriaSimple=null,this._sortFunction=null,this._sortByScoring=null,this._queueSortPhase(),this}applySortByScoring(e=!1){return this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=e,this._queueSortPhase(),this}getScoring(){return this._resultSet.getScoring()}startTransaction(){return this._cachedResultSet=this._resultSet.copy(),this}commit(){return this._cachedResultSet=null,this}rollback(){return this._resultSet=this._cachedResultSet,this._persistent&&(this._resultData=this._resultSet.data(),this.emit("rebuild",this)),this}_indexOfFilterWithId(e){if("string"==typeof e||"number"==typeof e)for(let t=0,i=this._filterPipeline.length;t<i;t++)if(e===this._filterPipeline[t].uid)return t;return-1}_addFilter(e){this._filterPipeline.push(e),this._resultSet[e.type](e.val)}reapplyFilters(){this._resultSet.reset(),this._cachedResultSet=null,this._persistent&&(this._resultData=[],this._resultDirty=!0);const e=this._filterPipeline;this._filterPipeline=[];for(let t=0,i=e.length;t<i;t++)this._addFilter(e[t]);return this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||null!==this._sortByScoring?this._queueSortPhase():this._queueRebuildEvent(),this}applyFilter(e){const t=this._indexOfFilterWithId(e.uid);return t>=0?(this._filterPipeline[t]=e,this.reapplyFilters()):(this._cachedResultSet=null,this._persistent&&(this._resultData=[],this._resultDirty=!0),this._addFilter(e),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||null!==this._sortByScoring?this._queueSortPhase():this._queueRebuildEvent(),this)}applyFind(e,t=""){return this.applyFilter({type:"find",val:e,uid:t}),this}applyWhere(e,t){return this.applyFilter({type:"where",val:e,uid:t}),this}removeFilter(e){const t=this._indexOfFilterWithId(e);if(t<0)throw new Error("Dynamic view does not contain a filter with ID: "+e);return this._filterPipeline.splice(t,1),this.reapplyFilters(),this}count(){return this._resultDirty&&(this._resultData=this._resultSet.data()),this._resultSet.count()}data(e={}){return(this._sortDirty||this._resultDirty)&&this._performSortPhase({suppressRebuildEvent:!0}),this._persistent?this._resultData:this._resultSet.data(e)}_queueRebuildEvent(){this._rebuildPending||(this._rebuildPending=!0,setTimeout((()=>{this._rebuildPending&&(this._rebuildPending=!1,this.emit("rebuild",this))}),this._minRebuildInterval))}_queueSortPhase(){this._sortDirty||(this._sortDirty=!0,"active"===this._sortPriority?setTimeout((()=>{this._performSortPhase()}),this._minRebuildInterval):this._queueRebuildEvent())}_performSortPhase(e={}){(this._sortDirty||this._resultDirty)&&(this._sortDirty&&(this._sortFunction?this._resultSet.sort(this._sortFunction):this._sortCriteria?this._resultSet.compoundsort(this._sortCriteria):this._sortCriteriaSimple?this._resultSet.simplesort(this._sortCriteriaSimple.field,this._sortCriteriaSimple.options):null!==this._sortByScoring&&this._resultSet.sortByScoring(this._sortByScoring),this._sortDirty=!1),this._persistent&&(this._resultData=this._resultSet.data(),this._resultDirty=!1),e.suppressRebuildEvent||this.emit("rebuild",this))}_evaluateDocument(e,t){if(!this._resultSet._filterInitialized)return this._persistent&&(this._resultData=this._resultSet.data()),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent());const i=this._resultSet._filteredRows,s=t?-1:i.indexOf(+e),r=i.length,n=new _(this._collection);let a;n._filteredRows=[e],n._filterInitialized=!0;for(let e=0,t=this._filterPipeline.length;e<t;e++)a=this._filterPipeline[e],n[a.type](a.val);const l=0===n._filteredRows.length?-1:0;return-1!==s||-1!==l?-1===s&&-1!==l?(i.push(e),this._persistent&&this._resultData.push(this._collection._data[e]),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())):-1!==s&&-1===l?(s<r-1?(i.splice(s,1),this._persistent&&this._resultData.splice(s,1)):(i.length=r-1,this._persistent&&(this._resultData.length=r-1)),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())):void(-1!==s&&-1!==l&&(this._persistent&&(this._resultData[s]=this._collection._data[e]),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())):void 0}_removeDocument(e){if(!this._resultSet._filterInitialized)return this._persistent&&(this._resultData=this._resultSet.data()),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent());const t=this._resultSet._filteredRows,i=t.indexOf(+e);let s=t.length;-1!==i&&(i<s-1?(t[i]=t[s-1],t.length=s-1,this._persistent&&(this._resultData[i]=this._resultData[s-1],this._resultData.length=s-1)):(t.length=s-1,this._persistent&&(this._resultData.length=s-1)),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent()),s=t.length;for(let i=0;i<s;i++)t[i]>e&&t[i]--}mapReduce(e,t){try{return t(this.data().map(e))}catch(e){throw e}}}var p=i(4),g=i(1);function m(e){return e.reduce(((e,t)=>e+t),0)/e.length}function v(e,t,i,s=0){if(void 0===e)return!1;if(s+1===t.length)return i.push(e[t[s]]),!1;const r=e[t[s]];if(Array.isArray(r)){for(let e=0;e<r.length;e++)v(r[e],t,i,s+1);return!0}return v(r,t,i,s+1)}i.d(t,"a",(function(){return b}));class b extends s.a{constructor(e,t={}){if(super(),this._data=[],this._idIndex=[],this._rangedIndexes={},this._lokimap={},this._unindexedSortComparator="js",this._defaultLokiOperatorPackage="js",this._constraints={unique:{}},this._transforms={},this._dirty=!0,this._cached=null,this._nestedProperties=[],this._ttl={age:null,ttlInterval:null,daemon:null},this._maxId=0,this._dynamicViews=[],this._changes=[],this._stages={},this._commitLog=[],t&&!0===t.disableMeta){if(!1===t.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===t.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof t.ttl&&t.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}if(this.name=e,this._unindexedSortComparator=t.unindexedSortComparator||"js",this._defaultLokiOperatorPackage=t.defaultLokiOperatorPackage||"js",void 0!==t.unique&&(Array.isArray(t.unique)||(t.unique=[t.unique]),t.unique.forEach((e=>{this._constraints.unique[e]=new r(e)}))),void 0!==g.a.FullTextSearch?this._fullTextSearch=void 0!==t.fullTextSearch?new g.a.FullTextSearch(t.fullTextSearch):null:this._fullTextSearch=null,this._transactional=void 0!==t.transactional&&t.transactional,this._cloneObjects=void 0!==t.clone&&t.clone,this._asyncListeners=void 0!==t.asyncListeners&&t.asyncListeners,this._disableMeta=void 0!==t.disableMeta&&t.disableMeta,this._disableChangesApi=void 0===t.disableChangesApi||t.disableChangesApi,this._disableDeltaChangesApi=void 0===t.disableDeltaChangesApi||t.disableDeltaChangesApi,this._cloneMethod=void 0!==t.cloneMethod?t.cloneMethod:"deep",this._disableChangesApi&&(this._disableDeltaChangesApi=!0),this._serializableIndexes=void 0===t.serializableIndexes||t.serializableIndexes,null!=t.nestedProperties)for(let e=0;e<t.nestedProperties.length;e++){const i=t.nestedProperties[e];"string"==typeof i?this._nestedProperties.push({name:i,path:i.split(".")}):this._nestedProperties.push(i)}this.setTTL(t.ttl||-1,t.ttlInterval),this._events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this._ensureId();let i=t.rangedIndexes||{};for(let e in i)this.ensureRangedIndex(e,i[e].indexTypeName,i[e].comparatorName);this.setChangesApi(this._disableChangesApi,this._disableDeltaChangesApi),this.flushChanges()}toJSON(){return{name:this.name,unindexedSortComparator:this._unindexedSortComparator,defaultLokiOperatorPackage:this._defaultLokiOperatorPackage,_dynamicViews:this._dynamicViews,uniqueNames:Object.keys(this._constraints.unique),transforms:this._transforms,rangedIndexes:this._rangedIndexes,_data:this._data,idIndex:this._idIndex,maxId:this._maxId,_dirty:this._dirty,_nestedProperties:this._nestedProperties,transactional:this._transactional,asyncListeners:this._asyncListeners,disableMeta:this._disableMeta,disableChangesApi:this._disableChangesApi,disableDeltaChangesApi:this._disableDeltaChangesApi,cloneObjects:this._cloneObjects,cloneMethod:this._cloneMethod,changes:this._changes,_fullTextSearch:this._fullTextSearch}}static fromJSONObject(e,t){let i=new b(e.name,{disableChangesApi:e.disableChangesApi,disableDeltaChangesApi:e.disableDeltaChangesApi,unindexedSortComparator:e.unindexedSortComparator,defaultLokiOperatorPackage:e.defaultLokiOperatorPackage});if(i._transactional=e.transactional,i._asyncListeners=e.asyncListeners,i._disableMeta=e.disableMeta,i._disableChangesApi=e.disableChangesApi,i._cloneObjects=e.cloneObjects,i._cloneMethod=e.cloneMethod||"deep",i._changes=e.changes,i._nestedProperties=e._nestedProperties,i._rangedIndexes=e.rangedIndexes||{},i._dirty=!(!t||!0!==t.retainDirtyFlags)&&e._dirty,t&&void 0!==t[e.name]){let s=function(e){const i=t[e.name];if(i.proto){const e=i.inflate||((e,t)=>{for(let i in e)t[i]=e[i]});return t=>{const s=new i.proto;return e(t,s),s}}return i.inflate}(e);for(let t=0;t<e._data.length;t++)i._data[t]=i._defineNestedProperties(s(e._data[t])),i._lokimap[i._data[t].$loki]=i._data[t]}else for(let t=0;t<e._data.length;t++)i._data[t]=i._defineNestedProperties(e._data[t]),i._lokimap[i._data[t].$loki]=i._data[t];i._maxId=void 0===e.maxId?0:e.maxId,i._idIndex=e.idIndex,void 0!==e.transforms&&(i._transforms=e.transforms);for(let t in e.rangedIndexes){let s=e.rangedIndexes[t],r=(0,p.a[s.indexTypeName])(t,d.a[s.comparatorName]);r.restore(s.index),i._rangedIndexes[t].index=r}if(i._ensureId(),void 0!==e.uniqueNames)for(let t=0;t<e.uniqueNames.length;t++)i.ensureUniqueIndex(e.uniqueNames[t]);if(void 0!==e._dynamicViews)for(let t=0;t<e._dynamicViews.length;t++)i._dynamicViews.push(f.fromJSONObject(i,e._dynamicViews[t]));return e._fullTextSearch&&(i._fullTextSearch=g.a.FullTextSearch.fromJSONObject(e._fullTextSearch,t.fullTextSearch)),i}addTransform(e,t){if(void 0!==this._transforms[e])throw new Error("a transform by that name already exists");this._transforms[e]=t}getTransform(e){return this._transforms[e]}setTransform(e,t){this._transforms[e]=t}removeTransform(e){delete this._transforms[e]}setTTL(e,t){e<0?clearInterval(this._ttl.daemon):(this._ttl.age=e,this._ttl.ttlInterval=t,this._ttl.daemon=setInterval((()=>{const e=Date.now();this.chain().where((t=>{const i=t.meta.updated||t.meta.created,s=e-i;return this._ttl.age<s})).remove()}),t))}_prepareFullDocIndex(){const e=new Array(this._data.length);for(let t=0;t<e.length;t++)e[t]=t;return e}ensureIndex(e,t,i){this.ensureRangedIndex(e,t,i)}ensureRangedIndex(e,t,i){if(t=t||"avl",i=i||"loki",!p.a[t])throw new Error("ensureRangedIndex: Unknown range index type");if(!d.a[i])throw new Error("ensureRangedIndex: Unknown comparator");let s=p.a[t],r=d.a[i];this._rangedIndexes[e]={index:s(e,r),indexTypeName:t,comparatorName:i};let n=this._rangedIndexes[e].index;for(let t=0;t<this._data.length;t++)n.insert(this._data[t].$loki,this._data[t][e])}ensureUniqueIndex(e){let t=new r(e);this._constraints.unique[e]=t;for(let i=0;i<this._data.length;i++)t.set(this._data[i].$loki,this._data[i][e]);return t}count(e){return e?this.chain().find(e)._filteredRows.length:this._data.length}_ensureId(){this._idIndex=[];for(let e=0;e<this._data.length;e++)this._idIndex.push(this._data[e].$loki)}addDynamicView(e,t){const i=new f(this,e,t);return this._dynamicViews.push(i),i}removeDynamicView(e){for(let t=0;t<this._dynamicViews.length;t++)this._dynamicViews[t].name===e&&this._dynamicViews.splice(t,1)}getDynamicView(e){for(let t=0;t<this._dynamicViews.length;t++)if(this._dynamicViews[t].name===e)return this._dynamicViews[t];return null}findAndUpdate(e,t){this.chain().find(e).update(t)}findAndRemove(e){this.chain().find(e).remove()}insert(e){if(!Array.isArray(e))return this.insertOne(e);let t,i=[];this.emit("pre-insert",e);for(let s=0;s<e.length;s++){if(t=this.insertOne(e[s],!0),!t)return;i.push(t)}return this.emit("insert",i),i=this._cloneObjects?o(i,this._cloneMethod):i,1===i.length?i[0]:i}insertOne(e,t=!1){let i,s=null;if("object"!=typeof e?s=new TypeError("Document needs to be an object"):null===e&&(s=new TypeError("Object cannot be null")),null!==s)throw this.emit("error",s),s;const r=this._defineNestedProperties(this._cloneObjects?o(e,this._cloneMethod):e);if(this._disableMeta||void 0!==r.meta||(r.meta={version:0,revision:0,created:0}),t||this.emit("pre-insert",r),this._add(r))return this._disableChangesApi?this._insertMeta(r):this._insertMetaWithChange(r),i=this._cloneObjects?o(r,this._cloneMethod):r,t||this.emit("insert",i),i}_defineNestedProperties(e){for(let t=0;t<this._nestedProperties.length;t++){const i=this._nestedProperties[t].name,s=this._nestedProperties[t].path;Object.defineProperty(e,i,{get(){const e=[];return v(this,s,e)?e:e[0]},set(e){s.slice(0,s.length-1).reduce(((e,t)=>e&&e[t]?e[t]:null),this)[s[s.length-1]]=e},enumerable:!1,configurable:!0})}return e}clear({removeIndices:e=!1}={}){if(this._data=[],this._idIndex=[],this._cached=null,this._maxId=0,this._dynamicViews=[],this._dirty=!0,!0===e)this._rangedIndexes={},this._constraints={unique:{}};else{for(let e in this._rangedIndexes)this.ensureRangedIndex(e,this._rangedIndexes[e].indexTypeName,this._rangedIndexes[e].comparatorName);const e=Object.keys(this._constraints.unique);for(let t=0;t<e.length;t++)this._constraints.unique[e[t]].clear()}null!==this._fullTextSearch&&this._fullTextSearch.clear()}update(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.update(e[t]);else{if(void 0===e.$loki)throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();const t=this.get(e.$loki,!0);if(!t)throw new Error("Trying to update a document not in collection.");let i=t[0],s=t[1],r=this._defineNestedProperties(this._cloneObjects||!this._disableDeltaChangesApi?o(e,this._cloneMethod):e);this.emit("pre-update",e),Object.keys(this._constraints.unique).forEach((e=>{this._constraints.unique[e].update(r.$loki,r[e])})),this._data[s]=r,this._lokimap[e.$loki]=r;for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e]._evaluateDocument(s,!1);for(let t in this._rangedIndexes)this._rangedIndexes[t].index.update(e.$loki,e[t]);this._idIndex[s]=r.$loki,null!==this._fullTextSearch&&this._fullTextSearch.updateDocument(e,s),this.commit(),this._dirty=!0,this._disableChangesApi?this._updateMeta(r):this._updateMetaWithChange(r,i);let n=r;this._cloneObjects&&(n=o(r,this._cloneMethod)),this.emit("update",n,i)}catch(e){throw this.rollback(),this.emit("error",e),e}}}_add(e){if("object"!=typeof e)throw new TypeError("Object being added needs to be an object");if(void 0!==e.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this._maxId++,isNaN(this._maxId)&&(this._maxId=this._data[this._data.length-1].$loki+1);const t=e;t.$loki=this._maxId,this._disableMeta||(t.meta.version=0);const i=this._constraints.unique;for(const e in i)void 0!==i[e]&&i[e].set(t.$loki,t[e]);this._idIndex.push(t.$loki),this._lokimap[t.$loki]=t,this._data.push(t);const s=this._data.length-1,r=this._dynamicViews.length;for(let e=0;e<r;e++)this._dynamicViews[e]._evaluateDocument(s,!0);for(let i in this._rangedIndexes)this._serializableIndexes&&t[i]instanceof Date&&(t[i]=t[i].getTime()),this._rangedIndexes[i].index.insert(e.$loki,e[i]);return null!==this._fullTextSearch&&this._fullTextSearch.addDocument(t,s),this.commit(),this._dirty=!0,this._cloneObjects?o(t,this._cloneMethod):t}catch(e){throw this.rollback(),this.emit("error",e),e}}updateWhere(e,t){const i=this.where(e);try{for(let e=0;e<i.length;e++)this.update(t(i[e]))}catch(e){throw this.rollback(),e}}removeWhere(e){this.remove(this._data.filter(e))}removeDataOnly(){this.remove(this._data.slice())}remove(e){if("number"==typeof e&&(e=this.get(e)),Array.isArray(e)){let t=0;const i=e.length;for(;t<i;t++)this.remove(e[t])}else{if(void 0===e.$loki)throw new Error("Object is not a document stored in the collection");try{this.startTransaction();const t=this.get(e.$loki,!0),i=t[1];let s="number"==typeof e?this.get(e):e;Object.keys(this._constraints.unique).forEach((e=>{e in s&&this._constraints.unique[e].remove(s.$loki)}));for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e]._removeDocument(i);this._data.splice(i,1),this._idIndex.splice(i,1),delete this._lokimap[e.$loki];for(let t in this._rangedIndexes)this._rangedIndexes[t].index.remove(e.$loki);null!==this._fullTextSearch&&this._fullTextSearch.removeDocument(e,i),this.commit(),this._dirty=!0,this._disableChangesApi||this._createChange(this.name,"R",t[0]),this.emit("delete",t[0]),delete e.$loki,delete e.meta}catch(e){throw this.rollback(),this.emit("error",e),e}}}getChanges(){return this._changes}setChangesApi(e,t=!0){this._disableChangesApi=e,this._disableDeltaChangesApi=!!e||t}flushChanges(){this._changes=[]}_getObjectDelta(e,t){const i=null!==t&&"object"==typeof t?Object.keys(t):null;if(i&&i.length&&["string","boolean","number"].indexOf(typeof t)<0){const s={};for(let r=0;r<i.length;r++){const n=i[r];if(t.hasOwnProperty(n))if(e.hasOwnProperty(n)&&void 0===this._constraints.unique[n]&&"$loki"!==n&&"meta"!==n){const i=this._getObjectDelta(e[n],t[n]);void 0!==i&&i!=={}&&(s[n]=i)}else s[n]=t[n]}return 0===Object.keys(s).length?void 0:s}return e===t?void 0:t}_getChangeDelta(e,t){return t?this._getObjectDelta(t,e):JSON.parse(JSON.stringify(e))}_createChange(e,t,i,s){this._changes.push({name:e,operation:t,obj:"U"!==t||this._disableDeltaChangesApi?JSON.parse(JSON.stringify(i)):this._getChangeDelta(i,s)})}_createInsertChange(e){this._createChange(this.name,"I",e)}_createUpdateChange(e,t){this._createChange(this.name,"U",e,t)}_insertMetaWithChange(e){this._insertMeta(e),this._createInsertChange(e)}_updateMetaWithChange(e,t){this._updateMeta(e),this._createUpdateChange(e,t)}_insertMeta(e){this._disableMeta||(e.meta||(e.meta={version:0,revision:0,created:0}),e.meta.created=(new Date).getTime(),e.meta.revision=0)}_updateMeta(e){this._disableMeta||(e.meta.updated=(new Date).getTime(),e.meta.revision+=1)}get(e,t=!1){if(!t){let t=this._lokimap[e];return void 0===t?null:t}const i=this._idIndex;let s=i.length-1,r=0,n=r+s>>1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))throw new TypeError("Passed id is not an integer");for(;i[r]<i[s];)n=r+s>>1,i[n]<e?r=n+1:s=n;return s===r&&i[r]===e?t?[this._data[r],r]:this._data[r]:null}by(e,t){let i=this._constraints.unique[e].get(t);return this._cloneObjects?o(this._lokimap[i],this._cloneMethod):this._lokimap[i]}findOne(e){e=e||{};const t=this.chain().find(e,!0).data();return Array.isArray(t)&&0===t.length?null:this._cloneObjects?o(t[0],this._cloneMethod):t[0]}chain(e,t){const i=new _(this);return void 0===e?i:i.transform(e,t)}find(e){return this.chain().find(e).data()}findOneUnindexed(e,t){let i,s=this._data.length;for(;s--;)if(this._data[s][e]===t)return i=this._data[s],i;return null}startTransaction(){if(this._transactional){let e={};for(let t in this._rangedIndexes)e[t].indexTypeName=this._rangedIndexes[t].indexTypeName,e[t].comparatorName=this._rangedIndexes[t].comparatorName,e[t].index=this._rangedIndexes[t].index.backup();this._cached={index:this._idIndex,data:o(this._data,this._cloneMethod),rangedIndexes:e};for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e].startTransaction()}}commit(){if(this._transactional){this._cached=null;for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e].commit()}}rollback(){if(this._transactional&&null!==this._cached){this._idIndex=this._cached.index,this._data=this._cached.data;for(let e=0;e<this._data.length;e++)this._data[e]=this._defineNestedProperties(this._data[e]);for(let e in this._cached.rangedIndexes){let t=this._cached.rangedIndexes[e],i=(0,p.a[t.indexTypeName])(e,d.a[t.comparatorName]);i.restore(t.index),this._rangedIndexes[e].index=i}for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e].rollback()}}where(e){return this.chain().where(e).data()}mapReduce(e,t){return t(this._data.map(e))}eqJoin(e,t,i,s,r){return new _(this).eqJoin(e,t,i,s,r)}getStage(e){return this._stages[e]||(this._stages[e]={}),this._stages[e]}stage(e,t){const i=JSON.parse(JSON.stringify(t));return this.getStage(e)[t.$loki]=i,i}commitStage(e,t){const i=this.getStage(e),s=(new Date).getTime();for(const e in i)this.update(i[e]),this._commitLog.push({timestamp:s,message:t,data:JSON.parse(JSON.stringify(i[e]))});this._stages[e]={}}extract(e){const t=[];for(let i=0;i<this._data.length;i++)t.push(this._data[i][e]);return t}min(e){return Math.min.apply(null,this.extractNumerical(e))}max(e){return Math.max.apply(null,this.extractNumerical(e))}minRecord(e){const t={index:0,value:0};if(0===this._data.length)return t.index=null,t.value=null,t;t.index=this._data[0].$loki,t.value=parseFloat(this._data[0][e]);for(let i=1;i<this._data.length;i++){const s=parseFloat(this._data[i][e]);t.value>s&&(t.value=s,t.index=this._data[i].$loki)}return t}maxRecord(e){const t={index:0,value:0};if(0===this._data.length)return t.index=null,t.value=null,t;t.index=this._data[0].$loki,t.value=parseFloat(this._data[0][e]);for(let i=1;i<this._data.length;i++){const s=parseFloat(this._data[i][e]);t.value<s&&(t.value=s,t.index=this._data[i].$loki)}return t}extractNumerical(e){return this.extract(e).map(parseFloat).filter(Number).filter((e=>!isNaN(e)))}avg(e){return m(this.extractNumerical(e))}stdDev(e){return function(e){const t=m(e),i=m(e.map((e=>{const i=e-t;return i*i})));return Math.sqrt(i)}(this.extractNumerical(e))}mode(e){const t={},i=this.extractNumerical(e);let s=i[0],r=-1/0;for(let e=0;e<i.length;e++){const n=i[e];t[n]?t[n]++:t[n]=1,t[n]>r&&(s=n,r=t[n])}return s}median(e){const t=this.extractNumerical(e);t.sort(((e,t)=>e-t));const i=Math.floor(t.length/2);return t.length%2?t[i]:(t[i-1]+t[i])/2}}},function(e,t,i){"use strict";class s{constructor(e,t){this.nodes={},this.apex=null,this.name=e,this.comparator=t}backup(){let e=new s(this.name,this.comparator);return e.nodes=JSON.parse(JSON.stringify(this.nodes)),e.apex=this.apex,e}restore(e){this.name=e.name,this.comparator=e.comparator,this.nodes=JSON.parse(JSON.stringify(e.nodes)),this.apex=e.apex}insert(e,t){if(e<=0)throw new Error("avl index ids are required to be numbers greater than zero");let i=this.nodes[e]={id:e,value:t,parent:null,balance:0,height:0,left:null,right:null,siblings:[]};this.apex?this.insertNode(this.nodes[this.apex],i):this.apex=e}insertNode(e,t){switch(this.comparator(t.value,e.value)){case 0:e.siblings.push(t.id),t.parent=e.id;break;case 1:e.right?(this.insertNode(this.nodes[e.right],t),this.updateBalance(e)):(e.right=t.id,t.parent=e.id,this.updateBalance(e));break;case-1:e.left?(this.insertNode(this.nodes[e.left],t),this.updateBalance(e)):(e.left=t.id,t.parent=e.id,this.updateBalance(e));break;default:throw new Error("Invalid comparator result")}if(e.balance<-1){if(null===e.left)throw new Error("insertNode.balance() : left child should not be null");this.nodes[e.left].balance<=0?this.leftLeftCase(e):this.leftRightCase(e)}if(e.balance>1){if(null===e.right)throw new Error("insertNode.balance() : right child should not be null");this.nodes[e.right].balance>=0?this.rightRightCase(e):this.rightLeftCase(e)}return e.height}updateBalance(e){let t=e.left?this.nodes[e.left].height:-1,i=e.right?this.nodes[e.right].height:-1;e.height=t>i?1+t:1+i,e.balance=i-t}leftLeftCase(e){return this.rotateRight(e)}leftRightCase(e){if(!e.left)throw new Error("leftRightCase: left child not set");return e.left=this.rotateLeft(this.nodes[e.left]).id,this.rotateRight(e)}rightRightCase(e){return this.rotateLeft(e)}rightLeftCase(e){if(!e.right)throw new Error("rightLeftCase: right child not set");return e.right=this.rotateRight(this.nodes[e.right]).id,this.rotateLeft(e)}rotateLeft(e){if(!e.right)throw new Error("rotateLeft: right child was unavailable.");let t=e.parent?this.nodes[e.parent]:null,i=this.nodes[e.right];if(e.right=i.left,e.right&&(this.nodes[e.right].parent=e.id),i.left=e.id,i.parent=e.parent,e.parent=i.id,t)if(t.left===e.id)t.left=i.id;else{if(t.right!==e.id)throw new Error("rotateLeft() : attempt to remap parent back to child failed... not found");t.right=i.id}else{if(this.apex!==e.id)throw new Error("rightRotate expecting parentless node to be apex");this.apex=i.id}return this.updateBalance(e),this.updateBalance(i),i}rotateRight(e){if(!e.left)throw new Error("rotateRight : left child unavailable");let t=e.parent?this.nodes[e.parent]:null,i=this.nodes[e.left];if(e.left=i.right,i.right&&(this.nodes[i.right].parent=e.id),i.right=e.id,i.parent=e.parent,e.parent=i.id,t)t.left===e.id?t.left=i.id:t.right=i.id;else{if(this.apex!==e.id)throw new Error("rightRotate expecting parentless node to be apex");this.apex=i.id}return this.updateBalance(e),this.updateBalance(i),i}getValuesAsTree(e){return null===this.apex?null:{id:(e=e||this.nodes[this.apex]).id,val:e.value,siblings:e.siblings,balance:e.balance,height:e.height,left:e.left?this.getValuesAsTree(this.nodes[e.left]):null,right:e.right?this.getValuesAsTree(this.nodes[e.right]):null}}update(e,t){let i=this.nodes[e];0!==this.comparator(i.value,t)&&(this.remove(e),this.insert(e,t))}remove(e){if(!this.apex)throw new Error("remove() : attempting remove when tree has no apex");this.removeNode(this.nodes[this.apex],e)}removeNode(e,t){if(!this.nodes[t])throw new Error("removeNode: attempting to remove a node which is not in hashmap");let i=this.nodes[t].value;switch(this.comparator(i,e.value)){case 0:if(e.siblings.length>0){if(e.id===t){let i=e.siblings.shift(),s=this.nodes[i];s.parent=e.parent,this.updateChildLink(e.parent,t,i),e.left&&(this.nodes[e.left].parent=i),e.right&&(this.nodes[e.right].parent=i),s.left=e.left,s.right=e.right,s.siblings=e.siblings,s.height=e.height,s.balance=e.balance,this.apex===t&&(this.apex=i);for(let e of s.siblings)this.nodes[e].parent=i;return void delete this.nodes[t]}{let i=e.siblings.indexOf(t);if(-1===i)throw new Error("Unable to remove sibling from parented sibling");return e.siblings.splice(i,1),void delete this.nodes[t]}}return e.left||e.right?e.left&&e.right?void this.promoteSuccessor(e):(e.left&&(this.promoteChild(e,this.nodes[e.left]),this.apex===t&&(this.apex=e.left)),void(e.right&&(this.promoteChild(e,this.nodes[e.right]),this.apex===t&&(this.apex=e.right)))):(this.updateChildLink(e.parent,e.id,null),delete this.nodes[t],void(t===this.apex&&(this.apex=null)));case 1:if(!e.right)throw new Error("removeNode: Unable to find value in tree");this.removeNode(this.nodes[e.right],t);break;case-1:if(!e.left)throw new Error("removeNode: Unable to find value in tree");this.removeNode(this.nodes[e.left],t)}if(this.updateBalance(e),e.balance<-1){if(null===e.left)throw new Error("insertNode.balance() : left child should not be null");this.nodes[e.left].balance<=0?this.leftLeftCase(e):this.leftRightCase(e)}if(e.balance>1){if(null===e.right)throw new Error("insertNode.balance() : right child should not be null");this.nodes[e.right].balance>=0?this.rightRightCase(e):this.rightLeftCase(e)}}updateChildLink(e,t,i){if(null===e)return;let s=this.nodes[e];s.left===t?s.left=i:s.right===t&&(s.right=i)}promoteChild(e,t){let i=e.parent;if(i){let s=this.nodes[i];s.left===e.id?s.left=t.id:s.right===e.id&&(s.right=t.id)}t.parent=i,delete this.nodes[e.id]}promoteSuccessor(e){let t=e.id;if(!e.right||!e.left)throw new Error("promoteSuccessor() : node to replace does not have two children");let i,s,r,n=null;if(e.balance<0){let t=this.nodes[e.left];n=this.findGreaterLeaf(t),i=n.id,s=n.value,r=n.siblings,n.siblings=[],this.removeNode(t,i)}else{let t=this.nodes[e.right];n=this.findLesserLeaf(t),i=n.id,s=n.value,r=n.siblings,n.siblings=[],this.removeNode(t,i)}if(e.parent){let s=this.nodes[e.parent];s.left===t&&(s.left=i),s.right===t&&(s.right=i)}e.left&&(this.nodes[e.left].parent=i),e.right&&(this.nodes[e.right].parent=i),e.id=i,e.value=s,e.siblings=r,this.nodes[i]=e,delete this.nodes[t],this.apex===t&&(this.apex=i),this.updateBalance(e)}findGreaterLeaf(e){if(!e.right)return e;let t=this.findGreaterLeaf(this.nodes[e.right]);return t||e}findLesserLeaf(e){if(!e.left)return e;let t=this.findLesserLeaf(this.nodes[e.left]);return t||e}rangeRequest(e){if(!this.apex)return[];if(!e)return this.collateIds(this.nodes[this.apex]);if("$eq"===e.op){let t=this.locate(this.nodes[this.apex],e.val);return null===t?[]:t.siblings.length?[t.id,...t.siblings]:[t.id]}return this.collateRequest(this.nodes[this.apex],e)}collateRequest(e,t){let i=[];if("$eq"===t.op)throw new Error("collateRequest does not support $eq range request");let s=this.comparator(e.value,t.val),r=0;if("$between"===t.op){if(null===t.high||void 0===t.high)throw new Error("collateRequest: $between request missing high range value");r=this.comparator(e.value,t.high)}if(e.left)switch(t.op){case"$lt":case"$lte":i=this.collateRequest(this.nodes[e.left],t);break;case"$gt":case"$gte":case"$between":1===s&&(i=this.collateRequest(this.nodes[e.left],t))}if(t)switch(t.op){case"$lt":-1===s&&(i.push(e.id),i.push(...e.siblings));break;case"$lte":-1!==s&&0!==s||(i.push(e.id),i.push(...e.siblings));break;case"$gt":1===s&&(i.push(e.id),i.push(...e.siblings));break;case"$gte":1!==s&&0!==s||(i.push(e.id),i.push(...e.siblings));break;case"$between":s>=0&&r<=0&&(i.push(e.id),i.push(...e.siblings))}else i.push(e.id),i.push(...e.siblings);if(e.right)if(t)switch(t.op){case"$lt":case"$lte":-1===s&&i.push(...this.collateRequest(this.nodes[e.right],t));break;case"$gt":case"$gte":i.push(...this.collateRequest(this.nodes[e.right],t));break;case"$between":-1===r&&i.push(...this.collateRequest(this.nodes[e.right],t))}else i.push(...this.collateRequest(this.nodes[e.right],t));return i}collateIds(e){let t=[];return e?(e.left&&(t=this.collateIds(this.nodes[e.left])),t.push(e.id),t.push(...e.siblings),e.right&&t.push(...this.collateIds(this.nodes[e.right])),t):[]}locate(e,t){for(;null!==e;)switch(this.comparator(t,e.value)){case 0:return e;case 1:if(!e.right)return null;e=this.nodes[e.right];break;case-1:if(!e.left)return null;e=this.nodes[e.left]}return null}validateIndex(){if(!this.apex)return 0===Object.keys(this.nodes).length;if(null!==this.nodes[this.apex].parent)return!1;let e=this.collateIds(this.nodes[this.apex]),t=Object.keys(this.nodes).length;if(e.length!==t)return!1;if(1===e.length)return null===this.nodes[e[0]].parent&&null===this.nodes[e[0]].left&&null===this.nodes[e[0]].right;for(let t=0;t<e.length-1;t++)if(1===this.comparator(this.nodes[e[t]].value,this.nodes[e[t+1]].value))return!1;return this.validateNode(this.nodes[this.apex])}validateNode(e){if(-1!==[e.parent,e.left,e.right].indexOf(e.id))return!1;let t=e.left?this.nodes[e.left].height:-1,i=e.right?this.nodes[e.right].height:-1,s=1+Math.max(t,i);if(e.height!==s)return!1;if(e.balance!==i-t)return!1;if(e.siblings.length>0)for(let t of e.siblings)if(this.nodes[t].parent!==e.id)return!1;if(e.left){if(this.nodes[e.left].parent!==e.id)return!1;if(!this.validateNode(this.nodes[e.left]))return!1}if(e.right){if(this.nodes[e.right].parent!==e.id)return!1;if(!this.validateNode(this.nodes[e.right]))return!1}return!0}}i.d(t,"a",(function(){return r}));let r={avl:(e,t)=>new s(e,t)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));class s{constructor(){this._events={},this._asyncListeners=!1}on(e,t){let i;return Array.isArray(e)?(e.forEach((e=>{this.on(e,t)})),t):(i=this._events[e],i||(i=this._events[e]=[]),i.push(t),t)}emit(e,...t){e&&this._events[e]&&this._events[e].forEach((e=>{this._asyncListeners?setTimeout((()=>{e(...t)}),1):e(...t)}))}addListener(e,t){return this.on(e,t)}removeListener(e,t){if(Array.isArray(e)&&e.forEach((e=>{this.removeListener(e,t)})),this._events[e]){const i=this._events[e];i.splice(i.indexOf(t),1)}}}},function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return d}));var s=i(5),r=i(3),n=i(1),a=i(0),l=i(4),o=i(2);function h(){if(void 0!==e&&(e.android||e.NSObject))return"NATIVESCRIPT";if(void 0!==e&&"[object process]"==={}.toString.call(e.process))return e.window,"NODEJS";if(void 0!==document)return-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER";if(void 0!==window&&"[object Window]"==={}.toString.call(window))return"BROWSER";throw SyntaxError("Unknown environment...")}class d extends s.a{constructor(e="loki.db",t={}){if(super(),this.databaseVersion=1.5,this.engineVersion=1.5,this._persistenceMethod=null,this._persistenceAdapter=null,this._throttledSaves=!0,this._throttledSaveRunning=null,this._throttledSavePending=null,this._autosave=!1,this._autosaveInterval=5e3,this._autosaveRunning=!1,this._autosaveHandler=Promise.resolve(),this.filename=e,this._collections=[],({serializationMethod:this._serializationMethod="normal",destructureDelimiter:this._destructureDelimiter="$<\n",env:this._env=h()}=t),this._events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]},t.comparatorMap)for(let e in t.comparatorMap)a.a[e]=t.comparatorMap[e];if(t.rangedIndexFactoryMap)for(let e in t.rangedIndexFactoryMap)l.a[e]=t.rangedIndexFactoryMap[e];if(t.lokiOperatorPackageMap)for(let e in t.lokiOperatorPackageMap)o.a[e]=t.lokiOperatorPackageMap[e];this.on("init",this.clearChanges)}initializePersistence(e={}){let t=this._autosaveDisable();({autosave:this._autosave=!1,autosaveInterval:this._autosaveInterval=5e3,persistenceMethod:this._persistenceMethod,throttledSaves:this._throttledSaves=!0}=e);const i={NODEJS:["fs-storage"],BROWSER:["local-storage","indexed-storage"],CORDOVA:["local-storage","indexed-storage"],MEMORY:["memory-storage"]},s={"fs-storage":n.a.FSStorage,"local-storage":n.a.LocalStorage,"indexed-storage":n.a.IndexedStorage,"memory-storage":n.a.MemoryStorage};if(void 0!==this._persistenceMethod){if("function"!=typeof s[this._persistenceMethod])throw Error("Unknown persistence method.");this._persistenceAdapter=new s[this._persistenceMethod]}if(void 0!==e.adapter&&(this._persistenceMethod="adapter",this._persistenceAdapter=e.adapter),null===this._persistenceAdapter){let e=i[this._env];if(e)for(let t=0;t<e.length;t++)if(s[e[t]]){this._persistenceMethod=e[t],this._persistenceAdapter=new s[e[t]];break}}return e.autoload&&(t=t.then((()=>this._loadDatabase(e.inflate,!0)))),t.then((()=>{this._autosaveEnable()}))}copy(e={}){const t=new d(this.filename,{env:this._env});if(t.loadJSONObject(this,{retainDirtyFlags:!0}),e.removeNonSerializable){t._persistenceAdapter=null;for(let e=0;e<t._collections.length;e++)t._collections[e]._constraints=null,t._collections[e]._ttl=null}return t}addCollection(e,t={}){for(let t=0;t<this._collections.length;t++)if(this._collections[t].name===e)return this._collections[t];const i=new r.a(e,t);return this._collections.push(i),i}loadCollection(e){if(!e.name)throw new Error("Collection must have a name property to be loaded");this._collections.push(e)}getCollection(e){for(let t=0;t<this._collections.length;t++)if(this._collections[t].name===e)return this._collections[t];return this.emit("warning","collection "+e+" not found"),null}renameCollection(e,t){const i=this.getCollection(e);return i&&(i.name=t),i}listCollections(){const e=[];for(let t=0;t<this._collections.length;t++)e.push({name:this._collections[t].name,count:this._collections[t].count()});return e}removeCollection(e){for(let t=0;t<this._collections.length;t++)if(this._collections[t].name===e){const i=new r.a(e,{}),s=this._collections[t];for(const e in s)void 0!==s[e]&&void 0!==i[e]&&(s[e]=i[e]);return void this._collections.splice(t,1)}}serialize(e={}){switch(void 0===e.serializationMethod&&(e.serializationMethod=this._serializationMethod),e.serializationMethod){case"normal":default:return JSON.stringify(this);case"pretty":return JSON.stringify(this,null,2);case"destructured":return this.serializeDestructured()}}toJSON(){return{_env:this._env,_serializationMethod:this._serializationMethod,_autosave:this._autosave,_autosaveInterval:this._autosaveInterval,_collections:this._collections,databaseVersion:this.databaseVersion,engineVersion:this.engineVersion,filename:this.filename,_persistenceAdapter:this._persistenceAdapter,_persistenceMethod:this._persistenceMethod,_throttledSaves:this._throttledSaves}}serializeDestructured(e={}){if(void 0===e.partitioned&&(e.partitioned=!1),void 0===e.delimited&&(e.delimited=!0),void 0===e.delimiter&&(e.delimiter=this._destructureDelimiter),!0===e.partitioned&&void 0!==e.partition&&e.partition>=0)return this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:e.partition});let t=new d(this.filename);t.loadJSONObject(this);for(let e=0;e<t._collections.length;e++)t._collections[e]._data=[];if(!0===e.partitioned&&-1===e.partition)return t.serialize({serializationMethod:"normal"});const i=[];i.push(t.serialize({serializationMethod:"normal"})),t=null;for(let t=0;t<this._collections.length;t++){let s=this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:t});if(!1===e.partitioned&&!1===e.delimited){if(!Array.isArray(s))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(let e=0;e<s.length;e++)i.push(s[e]),s[e]=null;i.push("")}else i.push(s)}return e.partitioned?(e.delimited,i):e.delimited?(i.push(""),i.join(e.delimiter)):(i.push(""),i)}serializeCollection(e={}){if(void 0===e.delimited&&(e.delimited=!0),void 0===e.collectionIndex)throw new Error("serializeCollection called without 'collectionIndex' option");const t=this._collections[e.collectionIndex].count();let i=[];for(let s=0;s<t;s++)i.push(JSON.stringify(this._collections[e.collectionIndex]._data[s]));return e.delimited?(i.push(""),i.join(e.delimiter)):i}deserializeDestructured(e,t={}){if(void 0===t.partitioned&&(t.partitioned=!1),void 0===t.delimited&&(t.delimited=!0),void 0===t.delimiter&&(t.delimiter=this._destructureDelimiter),t.partitioned){if(void 0!==t.partition)return-1===t.partition?JSON.parse(e[0]):this.deserializeCollection(e[t.partition+1],t);const i=JSON.parse(e[0]),s=i._collections.length;for(let r=0;r<s;r++)i._collections[r]._data=this.deserializeCollection(e[r+1],t);return i}let i=[];if(t.delimited){if(i=e.split(t.delimiter),e=null,0===i.length)return null}else i=e;const s=JSON.parse(i[0]),r=s._collections.length;i[0]=null;let n=0,a=1,l=!1;for(;!l;)""===i[a]?++n>r&&(l=!0):s._collections[n]._data.push(JSON.parse(i[a])),i[a++]=null;return s}deserializeCollection(e,t={}){void 0===t.partitioned&&(t.partitioned=!1),void 0===t.delimited&&(t.delimited=!0),void 0===t.delimiter&&(t.delimiter=this._destructureDelimiter);let i=[];t.delimited?(i=e.split(t.delimiter),i.pop()):i=e;for(let e=0;e<i.length;e++)i[e]=JSON.parse(i[e]);return i}loadJSON(e,t){let i;if(0===e.length)i={};else switch(this._serializationMethod){case"normal":case"pretty":default:i=JSON.parse(e);break;case"destructured":i=this.deserializeDestructured(e)}this.loadJSONObject(i,t)}loadJSONObject(e,t={}){const i=e._collections?e._collections.length:0;this.filename=e.filename,this._collections=[];for(let s=0;s<i;++s)this._collections.push(r.a.fromJSONObject(e._collections[s],t))}close(){return this._autosave?this._autosaveDisable().then((()=>this._autosaveDirty()?this.saveDatabase():Promise.resolve())):Promise.resolve().then((()=>{this.emit("close")}))}generateChangesNotification(e){let t=[];const i=e||this._collections.map((e=>e.name));return this._collections.forEach((e=>{-1!==i.indexOf(e.name)&&(t=t.concat(e.getChanges()))})),t}serializeChanges(e){return JSON.stringify(this.generateChangesNotification(e))}clearChanges(){this._collections.forEach((e=>{e.flushChanges&&e.flushChanges()}))}throttledSaveDrain(e={}){const t=(new Date).getTime();return this._throttledSaves?(void 0===e.recursiveWait&&(e.recursiveWait=!0),void 0===e.recursiveWaitLimit&&(e.recursiveWaitLimit=!1),void 0===e.recursiveWaitLimitDuration&&(e.recursiveWaitLimitDuration=2e3),void 0===e.started&&(e.started=new Date),this._throttledSaves&&null!==this._throttledSaveRunning?e.recursiveWait?Promise.resolve(Promise.all([this._throttledSaveRunning,this._throttledSavePending])).then((()=>null!==this._throttledSaveRunning||null!==this._throttledSavePending?e.recursiveWaitLimit&&t-e.started.getTime()>e.recursiveWaitLimitDuration?Promise.reject({}):this.throttledSaveDrain(e):Promise.resolve())):Promise.resolve(this._throttledSaveRunning):Promise.resolve()):Promise.resolve()}_loadDatabase(e={},t=!1){return null===this._persistenceAdapter?Promise.reject(new Error("persistenceAdapter not configured")):Promise.resolve(this._persistenceAdapter.loadDatabase(this.filename)).then((t=>{if("string"==typeof t)this.loadJSON(t,e),this.emit("load",this);else{if("object"!=typeof t||null===t||t instanceof Error)throw t;this.loadJSONObject(t,e),this.emit("load",this)}})).catch((e=>{if(e instanceof Error)throw e;if(null!=e)throw new TypeError("The persistence adapter did not load a serialized DB string or object.");if(!t)throw new Error("Database not found.")}))}loadDatabase(e={}){return this._throttledSaves?this.throttledSaveDrain(e).then((()=>(this._throttledSaveRunning=this._loadDatabase(e).then((()=>{this._throttledSaveRunning=null})),this._throttledSaveRunning)),(()=>{throw new Error("Unable to pause save throttling long enough to read database")})):this._loadDatabase(e)}_saveDatabase(){return null===this._persistenceAdapter?Promise.reject(new Error("persistenceAdapter not configured")):"reference"===this._persistenceAdapter.mode&&"function"==typeof this._persistenceAdapter.exportDatabase?Promise.resolve(this._persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}))).then((()=>{this._autosaveClearFlags(),this.emit("save")})):(this._autosaveClearFlags(),Promise.resolve(this._persistenceAdapter.saveDatabase(this.filename,this.serialize())).then((()=>{this.emit("save")})))}saveDatabase(){return this._throttledSaves?(null!==this._throttledSaveRunning&&null===this._throttledSavePending&&(this._throttledSavePending=Promise.resolve(this._throttledSaveRunning).then((()=>(this._throttledSaveRunning=null,this._throttledSavePending=null,this.saveDatabase())))),null!==this._throttledSavePending?this._throttledSavePending:(this._throttledSaveRunning=this._saveDatabase().then((()=>{this._throttledSaveRunning=null})),this._throttledSaveRunning)):this._saveDatabase()}deleteDatabase(){return null===this._persistenceAdapter?Promise.reject(new Error("persistenceAdapter not configured")):Promise.resolve(this._persistenceAdapter.deleteDatabase(this.filename))}_autosaveDirty(){for(let e=0;e<this._collections.length;e++)if(this._collections[e]._dirty)return!0;return!1}_autosaveClearFlags(){for(let e=0;e<this._collections.length;e++)this._collections[e]._dirty=!1}_autosaveEnable(){if(!this._autosave||this._autosaveRunning)return;this._autosaveRunning=!0;const e=setInterval((()=>{this._autosaveRunning?this._autosaveDirty()&&(this._autosaveHandler=this._autosaveHandler.then((()=>this.saveDatabase()))):clearInterval(e)}),this._autosaveInterval)}_autosaveDisable(){return this._autosaveRunning=!1,this._autosaveHandler}}}).call(this,i(7))},function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";i.r(t);var s=i(6);i.d(t,"Loki",(function(){return s.a}));var r=i(3);i.d(t,"Collection",(function(){return r.a})),s.a.Collection=r.a,t.default=s.a}])},e.exports=s()}}]);